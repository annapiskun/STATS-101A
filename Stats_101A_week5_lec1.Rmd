---
title: "Stats_101A_hw6_anna_piskun"
author: "Anna Piskun"
date: "2/4/2020"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(dplyr)
library(ggplot2)
```

Directions: 

### Question 1

Download the iowatest data. Iowa City is the home of the university of Iowa. Do schools in Iowa City out perform the rest? Answer, and provide supporting statistics and graphics (a graphic is required.) 

```{r}
setwd("~/Desktop")
iowatest <- read.table("iowatest.txt", header = T, sep = "\t", fill = FALSE)

plot(iowatest$Test)

iowa_city <- dplyr::filter(iowatest, City == "Iowa City")
other_cities <- dplyr::filter(iowatest, City != "Iowa City")

t.test(x = iowa_city$Test, y = other_cities$Test, alternative = "greater")

#Looking at our hypothesis test, since the p-value is less than 0.05 we reject the null hypothesis therefore supporting that yes, generally schools in Iowa City outperform their counterparts in other cities. 

#graphic
hist(other_cities$Test, col="red", xlab= "Test Scores", ylab= "Frequency", main= "Test Scores for Iowa City vs. Other Cities")
hist(iowa_city$Test, col="blue", add=TRUE)
legend("topright", c("Other Cities", "Iowa City"), fill=c("red", "blue"))
box()
```

### Question 2

Test scores are meant to reflect the success of a school's academic program. But many critics point out that factors other than academic success can influence a score. In particular, a school's score might be merely a reflection of the wealth of the student body. Address this issue by fitting a regression line to predict school test score from poverty score. Is there evidence that poverty is associated with the test score? 

```{r}
plot(Test ~ Poverty, data = iowatest)
iowa_lm <- lm(Test~Poverty, data = iowatest)
abline(iowa_lm)
plot(iowatest$Poverty, resid(iowa_lm))
cor(iowatest$Test, iowatest$Poverty)
summary(iowa_lm)

#Yes, there is evidence that poverty is associated with test scores. There is a strong, negative, linear relationship between test scores and poverty as modeled by our scatterplot and supported by a correlation coefficient value of -0.82. We further explore this by seeing that the residual plot is patternless, thus confirming that a linear model fits this data. Analyzing the plots, higher poverty schools had lower test scores on average. The intercept tells us that schools with 0% poverty (wealthiest schools) had an average test score of 74.6. If there was an equitable program across all schools in Iowa there would be 0 slope. 

```

### Question 3

Describe any weaknesses in your model. 

```{r}
plot(iowa_lm)
```

The residual plot shows no clear pattern or "fanshape" indicating that a linear model is a good fit for this data and there is constant variance. The Normal Q-Q plot is relatively straight (except for some variation at the tails) which tells us that the data follows a normal distribution. There is no increasing or decreasing trend in the scale location plot which combined with the residual plot confirms that our data meets the constant variance condition. The residual vs. leverage plot shows no high leverage/influential points. Therefore, the model is relatively strong and only has weaknesses due to a slight curvature in the residual plot which potentially indicates that a different model may fit better. Likewise there is one point on the residual v. leverage plot that may indicate an outlier which could have skewed the model. 

### Question 4

What would you consider to be a well-performing school among schools with an 80% poverty rating? 

```{r}
predict(iowa_lm, data.frame(Poverty = 80), interval = "prediction", level = 0.95)
```

A well-performing school among schools with an 80% poverty rating would recieve tests scores closer to the upper bound of the prediction interval, so that means a school with average test scores closer to ~49% can be considered well-performing when compared to the rest of its counterparts with an 80% poverty rating. 

### Question 5

Create a statistical graphic that illustrates how the relationship between poverty and test scores varies by city. 
```{r}
ggplot(iowatest, aes(Poverty, Test, colour = City)) +
  geom_point() +
  geom_smooth(se = FALSE, method = lm)
```

### Question 6

What hypothesis test is the F-test in the summary output for Question 2 testing? State the hypotheses and the conclusion from the test.

The hypothesis test that the F-test is testing is comparing the null model to the full model. Specifically, the null hypothesis states that adding another variable (in this case poverty) and therefore a slope to the model does not improve the model's ability to explain variation in test scores. The alternative hypothesis says that adding the poverty variable (and resulting slope) improves the model's ability to explain the variation in test scores. Since the F-value is large (269.8) and p-value is small (less than 0.05), we reject the null hypothesis and thus see that adding another variable and therefore a slope improves our model's predictive ability as well as its ability to explain variation in test scores. 



